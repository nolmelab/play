# 작업 로그 

가끔 적으면서 생각할 필요가 있습니다. 작업 로그로 남기고 나중에 문서화 하도록 합니다. 

## app

service 외에도 system / actor / component까지 활용하여 구조화를 포함합니다. 

게임에 필요한 구조이기에 좀 번거롭고 필요보다 크다고 해도 작은 구조에서 구조화가 더 쉽기도 하고 
필수적이기 때문입니다. 

- actor 
  - room 
  - front::user 
  - back::user

lobby_service, room_runner (service), room, room_master는 게임의 월드/게임 서버 구조에서
그대로 활용 가능한 모델입니다. 

## 유의할 점 

항상 잘 동작하는 완전한 분산 프로토콜이 되도록 노력합니다. 분산 처리는 동작하게 만드는 건 
쉽지만 항상 잘 동작하게 하는 건 어렵습니다. 프로토콜 자체에 헛점이 있을 수 있고 구현에서 
여러 가지 어려운 점들이 상존하기 때문입니다. 

일반 코딩도 실수를 많이 하는 편이기 때문에 분산처리의 어려움을 잘 구현해 내려면 
증명하는 수준의 검증이 항상 필요합니다. 

## 방 기능 

- 페이징 기능을 제공 
- 생성 순 
- 제목 순 
- 방장 순

boost::mutiindex 기능을 충분히 많이 써보려고 합니다. 여러 모로 도움이 될 것으로 예상합니다. 

## 이름 짓기 

규약이 있으면 수월해집니다. 프로토콜에 대한 작명 규칙은 대략 정했습니다. 

### 서비스 이름 

앞단의 게임 서버들에서 실행하는 서비스는 runner라고 합니다. remote_call_service와 같이 예외도 있습니다. 
뒷단의 서버들에서 실행하는 서비스는 master라고 합니다. master가 아닌 경우도 있겠으나
일단 정하면 나아지는 면이 있습니다. 그렇게 하면서 개선하도록 합니다. 

### namespace 

app과 ensure로 나눕니다. front / back 모두 app namespace를 사용합니다. 다른 모든 샘플들도 
이와 동일한 구조를 갖습니다. include 경로와 맞추서 하나로 합니다. 

```c++
#include <app/room_runner.hpp>

app::room_runner rr;
rr.start();
```

## 테스트 

sample들은 주로 ensure로 테스트를 합니다. 단위 테스트가 가능한 기능이 거의 없기 때문입니다.
단위 테스트가 필요한 경우가 있으며 또 하는 것이 대부분 이익입니다. 따라서, test 프로젝트는 
별도로 만들고 일부 테스트를 진행합니다. 

설계 과정에서 이해가 필요한 부분을 포함해서 단위 테스트를 진행합니다. 

ensure에 act를 미리 추가해 두고 바로 실행 가능한 정도로 구현한 상태 (빌드가 되는 상태)에서 
서버 기능을 구현하고 테스트를 통해 확인합니다. 이렇게 진행하는 것이 가장 효율적입니다. 

